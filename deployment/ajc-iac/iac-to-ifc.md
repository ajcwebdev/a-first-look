https://thenewstack.io/infrastructure-from-code-what-went-wrong/

# Links

https://raw.githubusercontent.com/awsdocs/aws-cdk-guide/refs/heads/main/v2/guide/toolkit-library.adoc
https://raw.githubusercontent.com/awsdocs/aws-cdk-guide/refs/heads/main/v2/guide/toolkit-library-examples.adoc
https://raw.githubusercontent.com/awsdocs/aws-cdk-guide/refs/heads/main/v2/guide/work-with-cdk-typescript.adoc
https://raw.githubusercontent.com/awsdocs/aws-cdk-guide/refs/heads/main/v2/guide/getting-started.adoc
https://raw.githubusercontent.com/awsdocs/aws-cdk-guide/refs/heads/main/v2/guide/core-concepts.adoc

https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform/v1.13.x/docs/language/index.mdx
https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform/v1.13.x/docs/cli/run/index.mdx
https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform/v1.13.x/docs/cli/init/index.mdx
https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform/v1.13.x/docs/cli/commands/index.mdx
https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform/v1.13.x/docs/intro/core-workflow.mdx
https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform/v1.13.x/docs/intro/index.mdx

https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform-cdk/v0.21.x/docs/cdktf/index.mdx
https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform-cdk/v0.21.x/docs/cdktf/api-reference/typescript/classes.mdx
https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform-cdk/v0.21.x/docs/cdktf/cli-reference/cli-configuration.mdx
https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform-cdk/v0.21.x/docs/cdktf/cli-reference/commands.mdx
https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform-cdk/v0.21.x/docs/cdktf/create-and-deploy/best-practices.mdx
https://raw.githubusercontent.com/hashicorp/web-unified-docs/refs/heads/main/content/terraform-cdk/v0.21.x/docs/cdktf/create-and-deploy/configuration-file.mdx

https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/esc/cli/_index.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/iac/cli/commands/pulumi_project.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/iac/cli/commands/pulumi_stack.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/iac/cli/commands/pulumi_stack_init.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/iac/cli/commands/pulumi_up.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/iac/cli/commands/pulumi_new.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/reference/cloud-rest-api/api-basics/_index.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/reference/cloud-rest-api/deployments/_index.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/reference/cloud-rest-api/personal-access-tokens/_index.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/reference/cloud-rest-api/services/_index.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/reference/cloud-rest-api/stacks/_index.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/reference/esc-syntax/_index.md
https://raw.githubusercontent.com/pulumi/docs/refs/heads/master/content/docs/reference/esc-syntax/top-level-keys/values.md

https://raw.githubusercontent.com/sst/sst/refs/heads/dev/www/src/content/docs/docs/workflow.mdx
https://raw.githubusercontent.com/sst/sst/refs/heads/dev/www/src/content/docs/docs/start/aws/bun.mdx
https://raw.githubusercontent.com/sst/sst/refs/heads/dev/www/src/content/docs/docs/components.mdx
https://raw.githubusercontent.com/sst/sst/refs/heads/dev/www/src/content/docs/docs/providers.mdx
https://raw.githubusercontent.com/sst/sst/refs/heads/dev/www/src/content/docs/docs/environment-variables.mdx
https://raw.githubusercontent.com/sst/sst/refs/heads/dev/www/src/content/docs/docs/iam-credentials.mdx
https://raw.githubusercontent.com/sst/sst/refs/heads/dev/www/src/content/docs/docs/reference-resources.mdx

https://alchemy.run/getting-started.md
https://alchemy.run/guides/cloudflare-bun-spa.md
https://alchemy.run/concepts/apps-and-stages.md
https://alchemy.run/concepts/resource.md
https://alchemy.run/concepts/bindings.md
https://alchemy.run/concepts/cli.md
https://alchemy.run/providers/aws/bucket.md
https://alchemy.run/providers/docker.md
https://alchemy.run/providers/docker/container.md
https://alchemy.run/providers/docker/volume.md

https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/index.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/get-started/installation.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/get-started/quickstart.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/get-started/foundations/projects/index.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/get-started/foundations/projects/configuration.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/get-started/foundations/infrastructure/index.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/get-started/foundations/infrastructure/resources.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/get-started/foundations/infrastructure/security.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/get-started/foundations/projects/local-development.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/get-started/foundations/deployment/index.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/architecture/index.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/architecture/services.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/apis.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/reference/nodejs/api/api.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/providers/pulumi/aws.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/reference/cli.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/reference/nodejs/storage/bucket.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/providers/index.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/providers/pulumi/index.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/websites.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/storage.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/architecture/apis.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/architecture/websites.mdx
https://raw.githubusercontent.com/nitrictech/nitric/refs/heads/main/docs/docs/architecture/buckets.mdx

https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/install.md
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/quick-start.mdx
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/concepts/hello-world.md
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/primitives/app-structure.md
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/primitives/services.mdx
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/primitives/defining-apis.mdx
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/primitives/object-storage.md
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/cli/cli-reference.md
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/cli/client-generation.md
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/cli/config-reference.md
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/frontend/hosting.mdx
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/frontend/cors.md
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/self-host/build.md
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/self-host/configure-infra.md
https://raw.githubusercontent.com/encoredev/encore/refs/heads/main/docs/ts/self-host/ci-cd.md

# Infrastructure as Code: From CloudFormation to Encore - A Progressive Tutorial

### Introduction

**What You'll Build**

- A Bun server running in a Docker container
- S3 bucket for object storage (read/write operations)
- SolidStart frontend deployed to a CDN with caching
- Complete infrastructure and deployment for each tool

**Learning Path**

- Start with pure YAML/JSON CloudFormation
- Progress through imperative programming approaches
- End with infrastructure inferred from application code
- Build the exact same application 9 times to understand trade-offs

**Prerequisites**

- Basic AWS knowledge (EC2, S3, CloudFront concepts)
- Docker fundamentals
- Node.js/TypeScript familiarity
- AWS account with CLI configured
- Git and command line basics

---

### Chapter 00: CloudFormation

**What is CloudFormation?**

AWS CloudFormation is Amazon's native Infrastructure as Code service that uses declarative templates (YAML or JSON) to provision and manage AWS resources. You describe the desired end state of your infrastructure, and CloudFormation figures out how to create, update, or delete resources to achieve that state.

**Where It Sits in the Progression**

CloudFormation is the foundation. It's AWS-native, directly maps to AWS APIs, and is what many higher-level tools compile down to. Understanding CloudFormation helps you understand what happens under the hood of tools like AWS CDK and SST.

**Learning Objectives**

- Understand AWS-native infrastructure as code
- Learn CloudFormation template structure (YAML/JSON)
- Master resource dependencies and intrinsic functions
- Deploy stacks via AWS Console and CLI

**Infrastructure Components**

- ECS cluster and task definition for Bun container
- ECR repository for Docker image
- S3 bucket with CORS configuration
- CloudFront distribution with S3 origin
- VPC with public/private subnets
- Security groups and IAM roles
- Application Load Balancer

**Key Concepts**

- Declarative infrastructure definition
- Stack lifecycle (create, update, delete)
- Resource dependencies and creation order
- Outputs for cross-stack references
- Intrinsic functions (Ref, GetAtt, Join)
- Change sets for previewing updates

---

### Chapter 01: Terraform

**What is Terraform?**

Terraform is HashiCorp's open-source Infrastructure as Code tool that uses HCL (HashiCorp Configuration Language) to provision resources across multiple cloud providers. It's declarative like CloudFormation, but cloud-agnostic and maintains its own state file to track infrastructure.

**Where It Sits in the Progression**

Terraform is the multi-cloud alternative to CloudFormation. It's also declarative and explicit, but works across AWS, GCP, Azure, and hundreds of other providers. It introduces the concept of state management and has a massive ecosystem of community modules.

**Learning Objectives**

- Learn HCL syntax and declarative approach
- Understand Terraform state management
- Master modules for reusability
- Compare Terraform vs CloudFormation philosophy

**Infrastructure Components**

- AWS provider configuration
- ECS cluster with Fargate tasks
- S3 bucket with lifecycle policies
- CloudFront distribution with cache behaviors
- VPC module from Terraform registry
- IAM policies and roles
- ALB with target groups

**Key Concepts**

- HCL configuration language
- State file and state locking
- Resource graph and dependencies
- Terraform plan vs apply
- Modules and workspaces
- Provider ecosystem

---

### Chapter 02: AWS CDK

**What is AWS CDK?**

AWS Cloud Development Kit (CDK) is a framework that lets you define AWS infrastructure using programming languages like TypeScript, Python, or Java. Instead of writing declarative templates, you write imperative code that synthesizes into CloudFormation templates.

**Where It Sits in the Progression**

CDK is the first tool in our progression that uses a programming language instead of configuration. It's imperative (you write steps) but still compiles down to CloudFormation's declarative format. This introduces higher-level abstracts called "constructs" that bundle multiple resources together.

**Learning Objectives**

- Transition from declarative to imperative IaC
- Use TypeScript to define infrastructure
- Understand constructs and composition
- Learn CDK synthesis to CloudFormation

**Infrastructure Components**

- ECS Fargate service with CDK L3 constructs
- S3 bucket with typed properties
- CloudFront distribution with behavior builder
- VPC construct with sensible defaults
- ApplicationLoadBalancedFargateService pattern
- Automatic IAM role generation

**Key Concepts**

- Constructs library (L1, L2, L3)
- Imperative vs declarative
- Programming language benefits (loops, conditionals)
- Compilation to CloudFormation
- CDK CLI and toolkit
- Assets and bundling

---

### Chapter 03: CDKTF (CDK for Terraform)

**What is CDKTF?**

CDK for Terraform (CDKTF) applies AWS CDK's programming language approach to Terraform instead of CloudFormation. You write TypeScript, Python, or other languages, and CDKTF synthesizes to Terraform JSON configuration, giving you the Terraform ecosystem with CDK's developer experience.

**Where It Sits in the Progression**

CDKTF bridges the gap between CDK (programming languages) and Terraform (multi-cloud ecosystem). You get CDK's imperative patterns and type safety, but instead of being locked into AWS/CloudFormation, you get access to Terraform's entire provider ecosystem.

**Learning Objectives**

- Combine programming languages with Terraform
- Understand CDK patterns applied to Terraform
- Learn synthesis to Terraform JSON
- Compare CDKTF to both CDK and Terraform

**Infrastructure Components**

- TerraformStack with TypeScript
- AWS provider via CDKTF constructs
- ECS resources using Terraform AWS provider
- S3 bucket with CDKTF builder pattern
- CloudFront distribution
- VPC from Terraform AWS modules

**Key Concepts**

- CDK patterns on Terraform foundation
- Access to entire Terraform ecosystem
- Synthesis to JSON (not HCL)
- Terraform state management
- Iterators and escape hatches
- Provider code generation

---

### Chapter 04: Pulumi

**What is Pulumi?**

Pulumi is an Infrastructure as Code platform that lets you write infrastructure using real programming languages. Unlike CDK and CDKTF which synthesize to intermediate formats, Pulumi code IS the deployment—it runs directly and makes API calls to provision resources.

**Where It Sits in the Progression**

Pulumi is where we stop compiling to intermediate formats. Your TypeScript code executes directly, using async/await for dependencies. This removes the limitations of CloudFormation and gives you the full power of a programming language. It's multi-cloud like Terraform, but imperative like CDK.

**Learning Objectives**

- Understand infrastructure as actual programs
- Learn Pulumi's execution model (no intermediate format)
- Master Pulumi state and secrets management
- Compare Pulumi to CDK, CDKTF, and Terraform

**Infrastructure Components**

- Pulumi program in TypeScript
- AWS ECS Fargate service
- S3 bucket with Pulumi resource options
- CloudFront distribution with async/await
- VPC using Pulumi Crosswalk
- Output values for cross-stack references

**Key Concepts**

- Your code IS the deployment
- No intermediate format (unlike CDK/CDKTF)
- Pulumi state service or self-managed
- Stack references for sharing data
- Secrets management built-in
- Component resources for composition

---

### Chapter 05: SST

**What is SST?**

SST (formerly Serverless Stack) is an application framework built on top of Pulumi that provides opinionated, high-level constructs for building fullstack serverless applications. It adds developer experience features like live Lambda development and a debugging console.

**Where It Sits in the Progression**

SST is the first framework (as opposed to pure IaC tool) in our progression. It uses Pulumi underneath but adds application-specific patterns and local development workflows. It's more opinionated than Pulumi—it knows you're building a fullstack app and optimizes for that use case.

**Learning Objectives**

- Understand application frameworks vs pure IaC
- Learn SST's opinionated fullstack patterns
- Master live Lambda development workflow
- See how SST builds on Pulumi

**Infrastructure Components**

- SST app with TypeScript configuration
- Bun container as SST Service construct
- S3 bucket with SST Bucket construct
- SolidStart site with SST SolidStart construct
- Automatic CDN and caching
- Built-in API Gateway if needed

**Key Concepts**

- Application framework vs IaC tool
- Opinionated defaults for fullstack apps
- SST constructs wrapping Pulumi
- Live development environment
- SST console for observability
- Framework-specific patterns

---

### Chapter 06: Alchemy

**What is Alchemy?**

Alchemy is a next-generation IaC framework built in pure ESM-native TypeScript that talks directly to cloud APIs via HTTPS requests. Unlike all previous tools, it has no compilation step, no external runtime, and no intermediate format—just TypeScript functions that make API calls.

**Where It Sits in the Progression**

Alchemy represents a radical simplification—it removes all abstraction layers between your code and cloud APIs. While CDK compiles to CloudFormation and CDKTF compiles to Terraform, Alchemy just makes direct HTTPS requests. It's the "Infrastructure FROM Code" paradigm starting to emerge.

**Learning Objectives**

- Understand pure TypeScript infrastructure approach
- Learn direct cloud API communication
- Master Infrastructure as Code without layers
- Compare Alchemy to all previous tools

**Infrastructure Components**

- Alchemy project in pure ESM TypeScript
- AWS resources as memoized async functions
- S3 bucket via direct AWS API
- CloudFront distribution
- ECS cluster and task definition
- No CloudFormation, Terraform, or Pulumi underneath

**Key Concepts**

- Pure ESM-native TypeScript
- Direct HTTPS calls to cloud APIs
- Memoized async functions as resources
- Local state files (no service)
- AI-first resource generation
- No abstraction layer or compiler

---

### Chapter 07: Nitric

**What is Nitric?**

Nitric is a multi-language framework that implements Infrastructure FROM Code (IfC) by automatically generating infrastructure requirements from your application code, then using Pulumi or Terraform plugins to provision resources. You declare infrastructure inline with your app logic.

**Where It Sits in the Progression**

Nitric is where we cross into true "Infrastructure FROM Code." Instead of writing infrastructure definitions, you write application code that declares what it needs (a bucket, a queue), and Nitric infers the infrastructure, generates a spec, and provisions it via Pulumi/Terraform plugins.

**Learning Objectives**

- Understand Infrastructure FROM Code paradigm
- Learn automatic infrastructure inference
- See how Nitric uses Pulumi/Terraform as plugins
- Master resource declaration in application code

**Infrastructure Components**

- Nitric application with inline infrastructure
- Bun server with API declarations
- S3 bucket declared via Nitric SDK
- Static site deployment
- Infrastructure spec auto-generated
- Pulumi/Terraform provisioning via plugins

**Key Concepts**

- Infrastructure FROM Code (IfC)
- Requirements specification generation
- Plugin architecture (Pulumi/Terraform)
- Resource declarations in app code
- Automatic permission management
- Cloud-agnostic abstractions

---

### Chapter 08: Encore

**What is Encore?**

Encore is a backend framework for TypeScript and Go that treats infrastructure as type-safe objects in your application code. At compile time, it generates an Application Model that's used to automatically provision infrastructure, generate documentation, and create architecture diagrams.

**Where It Sits in the Progression**

Encore is the most abstracted tool in our progression—the ultimate expression of Infrastructure FROM Code. There are no infrastructure files at all. Infrastructure is purely a consequence of your application's type definitions and structure. It's a complete platform, not just a tool.

**Learning Objectives**

- Master the most abstracted IfC approach
- Understand type-safe infrastructure objects
- Learn compile-time infrastructure generation
- See complete platform integration

**Infrastructure Components**

- Encore backend service in TypeScript
- Type-safe bucket declarations
- SolidStart frontend integration
- Docker container deployment
- Infrastructure from type definitions
- Automatic architecture diagrams

**Key Concepts**

- Infrastructure as type-safe objects
- Compile-time infrastructure generation
- Application Model concept
- Encore Cloud vs self-hosted
- Platform integration (docs, diagrams, tracing)
- Most opinionated approach

---

### Conclusion: Choosing Your Tool

**The Complete Spectrum**

From CloudFormation (explicit control, verbose YAML) to Encore (infrastructure inferred from types), we've seen the full evolution of Infrastructure as Code. Each tool makes different trade-offs between control and convenience.

**Comparison Matrix**

- Control vs Convenience spectrum
- Learning curve comparison
- Team size and expertise considerations
- Multi-cloud requirements
- Migration and portability
- Ecosystem maturity

**Decision Framework**

- When to use CloudFormation
- When to use Terraform
- When to use CDK/CDKTF/Pulumi
- When to use SST
- When to use Alchemy/Nitric/Encore

**The Evolution of IaC**

- From configuration to code
- From code to inference
- From tools to platforms
- Where the industry is heading

**Next Steps**

- Deep dive into chosen tool
- Community and resources
- Contributing to open source
- Building custom patterns